https://nvd.nist.gov/vuln/detail/CVE-2020-36242

tpl:
cryptography

vul func:
encrypt

cryptography 是一个旨在向 Python 开发人员公开加密原语和配方的软件包。
当update()发生某些具有大值（多个 GB）的对称加密或解密调用序列时，可能会发生整数溢出，从而导致缓冲区处理不当。
此问题已在 3.3.2 及更新版本中得到修补。

CVE-2020-36242 是一个在 Python 的 cryptography 包中发现的整数溢出和缓冲区溢出漏洞，影响版本低于 3.3.2 的 Fernet 加密功能。以下是漏洞的简要分析和可能的代码片段示例：

漏洞分析
当使用 Fernet 对称加密对大容量数据（多 GB）进行多次 update() 调用时，内部计算的缓冲区大小可能发生整数溢出，导致缓冲区溢出。

受影响代码片段（简化示例）：
Python
from cryptography.fernet import Fernet

key = Fernet.generate_key()
fernet = Fernet(key)

# 模拟多次大容量数据加密（漏洞触发场景）
data = b'A' * (4 * 1024 * 1024 * 1024)  # 4GB数据
for _ in range(1000):
    # 在 cryptography < 3.3.2 中，这可能导致整数溢出
    encrypted = fernet.encrypt(data)  # 内部多次调用update
