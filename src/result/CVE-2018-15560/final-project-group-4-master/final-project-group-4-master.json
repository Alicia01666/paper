[
    [
        {
            "function_name": "aes_ecb_encrypt",
            "file_path": "/PyVul/src/context/dataset/test_data/final-project-group-4-master/aes.py",
            "line_number": 107,
            "source_code": "def aes_ecb_encrypt(key, data, mode=AES.MODE_ECB):\n    #\u9ed8\u8ba4\u6a21\u5f0f\u4e3aECB\u52a0\u5bc6\n    aes = AES.new(key.encode('utf8'), mode)\n    new_data = aes.encrypt(data)\n    return new_data\n",
            "parameters": [],
            "focused_calls": [
                "encrypt"
            ],
            "conditions_for_focused_calls": {},
            "parameter_conditions": {},
            "is_vulnerability_reachable": false,
            "unique_id": "/PyVul/src/context/dataset/test_data/final-project-group-4-master/aes.py:aes_ecb_encrypt:107"
        },
        {
            "function_name": "encrypt_image_ecb",
            "file_path": "/PyVul/src/context/dataset/test_data/final-project-group-4-master/aes.py",
            "line_number": 58,
            "source_code": "def encrypt_image_ecb(filename):\n    #\u6253\u5f00bmp\u56fe\u7247\uff0c\u7136\u540e\u5c06\u4e4b\u8f6c\u6362\u4e3aRGB\u56fe\u50cf\n    im = PIL.Image.open(filename)\n    #\u5c06\u56fe\u50cf\u6570\u636e\u8f6c\u6362\u4e3a\u50cf\u7d20\u503c\u5b57\u8282\n    value_vector = im.convert(\"RGB\").tobytes()\n\n    imlength = len(value_vector)\n    #for i in range(original):\n        #print(data[i])\n    #\u5c06\u586b\u5145\u3001\u52a0\u5bc6\u540e\u7684\u6570\u636e\u8fdb\u884c\u50cf\u7d20\u503c\u6620\u5c04\n    value_encrypt = trans_format_RGB(aes_ecb_encrypt(key, pad(value_vector))[:imlength])\n    #for i in range(original):\n        #print(new[i])\n\n    #\u521b\u5efa\u4e00\u4e2a\u65b0\u5bf9\u8c61\uff0c\u5b58\u50a8\u76f8\u5bf9\u5e94\u7684\u503c\n    im2 = PIL.Image.new(im.mode, im.size)\n    im2.putdata(value_encrypt)\n\n    # \u5c06\u5bf9\u8c61\u4fdd\u5b58\u4e3a\u5bf9\u5e94\u683c\u5f0f\u7684\u56fe\u50cf\n    im2.save(filename_encrypted_ecb + \".\" + format, format)\n",
            "parameters": [],
            "focused_calls": [
                "value_encrypt = trans_format_RGB(aes_ecb_encrypt(key, pad(value_vector))[:imlength])"
            ],
            "conditions_for_focused_calls": {},
            "parameter_conditions": {},
            "is_vulnerability_reachable": false,
            "unique_id": "/PyVul/src/context/dataset/test_data/final-project-group-4-master/aes.py:encrypt_image_ecb:58"
        }
    ]
]
