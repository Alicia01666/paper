[
    [
        {
            "function_name": "create_user",
            "file_path": "PycharmProjects/PyVul/src/context/dataset/test_data/CVE-2020-36242/FastAPI/crud.py",
            "line_number": 47,
            "source_code": "def create_user(db: Session, user: schemas.UserCreate):\n    key = ''.join(random.choices(string.ascii_uppercase + string.ascii_lowercase + string.digits, k=10)) \n    api_key1 = f.encrypt(key.encode())\n    db_user = sql_model.User(username = user.username, email = user.email, api_key = api_key1)\n    db.add(db_user)\n    db.commit()\n    db.refresh(db_user)\n    api = db_user.api_key\n    return f.decrypt(api)\n",
            "parameters": [],
            "focused_calls": [
                "encrypt"
            ],
            "extend_calls": [],
            "conditions_for_focused_calls": {},
            "parameter_conditions": "",
            "is_vulnerability_reachable": false,
            "unique_id": "PycharmProjects/PyVul/src/context/dataset/test_data/CVE-2020-36242/FastAPI/crud.py:create_user:47"
        },
        {
            "function_name": "create",
            "file_path": "PycharmProjects/PyVul/src/context/dataset/test_data/CVE-2020-36242/FastAPI/main.py",
            "line_number": 23,
            "source_code": "def create(user: schemas.UserCreate, db: Session=Depends(get_db)):\n    db_user = crud.get_user_by_username(db, username = user.username)\n    if db_user:\n        raise HTTPException(status_code=401, detail=\"username already registered\")\n    return crud.create_user(db=db, user=user)\n",
            "parameters": [],
            "focused_calls": [
                "create_user"
            ],
            "extend_calls": [
                "def get_user_by_username(db: Session, username: str):\n    return db.query(sql_model.User).filter(sql_model.User.username == username).first()",
                "def create_user(db: Session, user: schemas.UserCreate):\n    key = ''.join(random.choices(string.ascii_uppercase + string.ascii_lowercase + string.digits, k=10)) \n    api_key1 = f.encrypt(key.encode())\n    db_user = sql_model.User(username = user.username, email = user.email, api_key = api_key1)\n    db.add(db_user)\n    db.commit()\n    db.refresh(db_user)\n    api = db_user.api_key\n    return f.decrypt(api)"
            ],
            "conditions_for_focused_calls": {},
            "parameter_conditions": "",
            "is_vulnerability_reachable": false,
            "unique_id": "PycharmProjects/PyVul/src/context/dataset/test_data/CVE-2020-36242/FastAPI/main.py:create:23"
        }
    ]
]
